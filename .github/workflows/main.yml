name: Create and publish a Docker image

on:
  push:
    branches: ['master']

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  build-and-publish-head:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2.5.0 # Checking out the repo
    - name: Get current date
      id: date
      run: echo "::set-output name=date::$(date +'%Y-%m-%d')"
    - name: Build and publish "head" Docker image
      uses: VaultVulp/gp-docker-action@1.6.0
      with:
        github-token: ${{ secrets.GH_TOKEN  }} # Provide GH_TOKEN  to login into the GitHub Packages
        image-name: kindle_dashboard # Provide Docker image name
        additional-image-tags: ${{ steps.date.outputs.date }}
        custom-args: --platform=linux/arm64,linux/amd64 
